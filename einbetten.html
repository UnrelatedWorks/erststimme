<html>
<head>
    <!-- Your styles here -->
    <script>
        // This function fetches the CSV file and returns a promise that resolves to the CSV text
        function fetchCsv(url) {
            return fetch(url)
                .then(response => response.text());
        }

        // This function takes a CSV string, splits it into lines, and then splits each line into fields
        // It creates a map where the keys are the PLZs and the values are the mdbids
        function parseCsv(csv) {
            var lines = csv.split('\n');
            var result = {};
            for (var i = 1; i < lines.length; i++) {
                var row = lines[i].split(',');
                var plz = row[0];
                var mdbid = row[1];
                result[plz] = mdbid;
            }
            return result;
        }

        var csvUrl = 'https://raw.githubusercontent.com/UnrelatedWorks/erststimme/main/plz2data-id.csv';
        var mdbidMap;

        fetchCsv(csvUrl)
            .then(csv => {
                mdbidMap = parseCsv(csv);
            });

        function getMdbIdFromCsv(plz) {
            return mdbidMap[plz];
        }

        function openForm() {
            var plz = document.getElementById('plz').value;
            var mdbid = getMdbIdFromCsv(plz);
            window.open('https://www.bundestag.de/services/formular/contactform?mdbId=' + mdbid, '_blank');
        }
    </script>
</head>
<body>
    <div class="form-container">
        <input type="text" id="plz" placeholder="PLZ">
        <button onclick="openForm()">Testen</button>
    </div>
</body>
</html>
